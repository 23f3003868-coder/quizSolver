<!DOCTYPE html>
<html>
<head>
    <title>Quiz Solver Demo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .question {
            margin: 20px 0;
            padding: 15px;
            background-color: #f9f9f9;
            border-left: 4px solid #007cba;
        }
        .instructions {
            background-color: #e7f3ff;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        button {
            background-color: #007cba;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 5px;
        }
        button:hover {
            background-color: #005a87;
        }
        .response {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            background-color: #f0f0f0;
        }
        .hidden {
            display: none;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .quiz-content {
            margin: 20px 0;
        }
        .quiz-content h3 {
            color: #007cba;
        }
        .answer-input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Quiz Solver Test Page</h1>
        
        <div class="instructions">
            <h3>Quiz Instructions</h3>
            <p>This is a demo quiz page to test your quiz solver. Your solver should:</p>
            <ol>
                <li>Read the question below</li>
                <li>Download and analyze any provided data files</li>
                <li>Calculate the correct answer</li>
                <li>Submit the answer to this page's submit endpoint</li>
            </ol>
        </div>
        
        <div class="question">
            <h3>Quiz Question #1</h3>
            <div class="quiz-content">
                <p>Download the <a href="/data/quiz-data.csv" id="data-link">CSV data file</a> and calculate the average of the "value" column.</p>
                <p>What is the average of the "value" column in the CSV file?</p>
            </div>
            
            <div>
                <label for="answer">Your Answer:</label>
                <input type="text" id="answer" class="answer-input" placeholder="Enter your calculated answer">
                <div>
                    <button onclick="submitAnswer()">Submit Answer</button>
                    <button onclick="skipQuiz()">Skip to Next Quiz</button>
                </div>
            </div>
        </div>
        
        <div id="response" class="response hidden"></div>
    </div>

    <script>
        // Function to submit answer
        function submitAnswer() {
            const answer = document.getElementById('answer').value;
            if (!answer) {
                showResponse('Please enter an answer', 'error');
                return;
            }
            
            // Submit to quiz endpoint
            const quizData = {
                email: "23f3003868@ds.study.iitm.ac.in",
                secret: "495669",
                url: window.location.href,
                answer: parseFloat(answer) || answer
            };
            
            fetch('/submit', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(quizData)
            })
            .then(response => response.json())
            .then(data => {
                if (data.correct) {
                    showResponse(`Correct! ${data.reason || 'Moving to next quiz...'}`, 'success');
                    if (data.url) {
                        setTimeout(() => {
                            window.location.href = data.url;
                        }, 2000);
                    }
                } else {
                    showResponse(`Incorrect: ${data.reason || 'Please try again.'}`, 'error');
                }
            })
            .catch(error => {
                showResponse(`Error submitting answer: ${error.message}`, 'error');
            });
        }
        
        // Function to skip to next quiz
        function skipQuiz() {
            // In a real scenario, you might have logic to get the next quiz URL
            showResponse('Skipping to next quiz...', 'success');
            setTimeout(() => {
                window.location.href = 'https://quizsolver-0cy6.onrender.com/next'; // Placeholder
            }, 1000);
        }
        
        // Function to show response
        function showResponse(message, type) {
            const responseDiv = document.getElementById('response');
            responseDiv.textContent = message;
            responseDiv.className = `response ${type}`;
            responseDiv.classList.remove('hidden');
        }
        
        // Simulated data file content (this would normally be a separate CSV file)
        // Creating a CSV with some sample values for testing
        document.addEventListener('DOMContentLoaded', function() {
            // Create a download link for CSV data
            const csvData = `name,value,category
John,10,A
Jane,20,B
Bob,30,A
Alice,40,B
Charlie,50,A`;
            
            const blob = new Blob([csvData], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            document.getElementById('data-link').href = url;
        });
    </script>
</body>
</html>